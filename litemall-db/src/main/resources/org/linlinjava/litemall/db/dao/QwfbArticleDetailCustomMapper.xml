<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.linlinjava.litemall.db.dao.QwfbArticleDetailCustomMapper">

	<resultMap id="BaseResultMap"
		type="org.linlinjava.litemall.db.domain.QwfbArticleDetailCustom">
		<id column="id" jdbcType="BIGINT" property="id" />
		<result column="title" jdbcType="VARCHAR" property="title" />
		<result column="user_id" jdbcType="INTEGER" property="userId" />
		<result column="article_id" jdbcType="BIGINT" property="articleId" />
		<result column="account_group_id" jdbcType="INTEGER" property="accountGroupId" />
		<result column="platform_id" jdbcType="INTEGER" property="platformId" />
		<result column="account_id" jdbcType="INTEGER" property="accountId" />
		<result column="account_name" jdbcType="VARCHAR" property="accountName" />
		<result column="category_id" jdbcType="VARCHAR" property="categoryId" />
		<result column="category_name" jdbcType="VARCHAR" property="categoryName" />
		<result column="published_url" jdbcType="VARCHAR" property="publishedUrl" />
		<result column="published_id" jdbcType="VARCHAR" property="publishedId" />
		<result column="published_type" jdbcType="INTEGER" property="publishedType" />
		<result column="published_attempt_times" jdbcType="INTEGER"
			property="publishedAttemptTimes" />
		<result column="last_published_time" jdbcType="TIMESTAMP"
			property="lastPublishedTime" />
		<result column="status" jdbcType="INTEGER" property="status" />
		<result column="statusHint" jdbcType="VARCHAR" property="statushint" />
		<result column="add_time" jdbcType="TIMESTAMP" property="addTime" />
		<result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
		<result column="deleted" jdbcType="BIT" property="deleted" />
	</resultMap>
	<resultMap extends="BaseResultMap" id="ResultMapWithBLOBs"
		type="org.linlinjava.litemall.db.domain.LitemallQwfbArticleDetail">
		<result column="content" jdbcType="LONGVARCHAR" property="content" />
	</resultMap>
	<sql id="Base_Column_List">
		id, title, user_id, article_id, account_group_id,
		platform_id,
		account_id, category_id,
		category_name, published_url,
		published_id, published_type, published_attempt_times,
		last_published_time, `status`, statusHint, add_time, update_time,
		deleted
	</sql>
	<sql id="Blob_Column_List">
		content
	</sql>

	<select id="getPlatNoPublishedList" parameterType="map" resultMap="BaseResultMap">
		select
			ad.id, ad.user_id, ad.article_id, ad.account_id, ad.account_group_id, ad.platform_id,
			IFNULL(ad.title, article.title) as title, ad.category_id, ad.category_name, ad.`status`, ad.status_hint, 
			ad.published_url, ad.published_id, ad.published_type, ad.published_attempt_times, ad.last_published_time 
		from litemall_qwfb_article_detail ad
			left join litemall_qwfb_article article on ad.article_id = article.id
		where ad.user_id = #{userId,jdbcType=INTEGER} and ad.deleted = 0
			and ad.last_published_time > #{lastPublishedTime,jdbcType=TIMESTAMP}
			and ad.platform_id = #{platformId,jdbcType=INTEGER} and ad.status != 3
	</select>
	
	<select id="getArticleDetailList" parameterType="map" resultMap="BaseResultMap">
		select
			ad.id, ad.user_id, ad.article_id, ad.account_id, ad.account_group_id, ad.platform_id, account.show_name as account_name, 
			IFNULL(ad.title, article.title) as title, ad.category_id, ad.category_name, ad.`status`, ad.status_hint, 
			ad.published_url, ad.published_id, ad.published_type, ad.published_attempt_times, ad.last_published_time 
		from litemall_qwfb_article_detail ad
			left join litemall_qwfb_article article on ad.article_id = article.id
			left join litemall_qwfb_account account on ad.account_id = account.id
		where ad.user_id = #{userId,jdbcType=INTEGER} and ad.deleted = 0
			and ad.article_id = #{articleId,jdbcType=BIGINT} 
	</select>
	
	
	<select id="getArticleDetailListDashboard" parameterType="map" resultMap="BaseResultMap">
		select
			ad.id, ad.user_id, ad.article_id, ad.account_id, ad.account_group_id, ad.platform_id, account.show_name as account_name, 
			IFNULL(ad.title, article.title) as title, ad.category_id, ad.category_name, ad.`status`, ad.status_hint, 
			ad.published_url, ad.published_id, ad.published_type, ad.published_attempt_times, ad.last_published_time 
		from litemall_qwfb_article_detail ad
			left join litemall_qwfb_article article on ad.article_id = article.id
			left join litemall_qwfb_account account on ad.account_id = account.id
		where ad.user_id = #{userId,jdbcType=INTEGER} and ad.deleted = 0 and ad.status = 4
			and ad.article_id = #{articleId,jdbcType=BIGINT} 
	</select>
	
	
</mapper>